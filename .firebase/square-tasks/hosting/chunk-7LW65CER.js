import{a as L,b as T,c as O,d as R,e as P,f as k,g as D,h as W,i as B,j as N,k as z}from"./chunk-GQ67NWOW.js";import{$ as S,C as u,F as g,I as o,J as a,M as d,T as l,W as f,X as h,Y as E,_ as b,a as _,aa as c,b as C,e as v,h as M,ha as y,l as U,p as m,pa as q,q as w,ua as F,z as p}from"./chunk-KWE7BIMZ.js";var j=(()=>{class i{apiService=m(D);login(t){return this.apiService.get(`users/${t}`).pipe(M(({status:n,error:e})=>v(()=>n===401?e.message:"An error occurred")))}register(t){return this.apiService.post("users",_({},t))}static \u0275fac=function(n){return new(n||i)};static \u0275prov=U({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var x=()=>["email"],A=i=>({placeholder:"email@example.com",validations:i,type:"email",typeField:"input"}),G=()=>["required"],V=i=>({placeholder:"Name",validations:i,typeField:"input"}),H=i=>({uppercase:!0,style:"primary",size:"full",type:"submit",disabled:i}),ge=(()=>{class i{authService=m(j);router=m(F);stateService=m(W);loginUser=u({email:""});registerUser=u({email:"",name:""});registerUserErrors=u([]);disabledRegisterButton=y(()=>this.registerUserErrors().length>0||!this.registerUser().name||!this.registerUser().email);messageError=u("");showRegisterDialog=y(()=>this.messageError()==="user not found");onLogin(){let{email:t,errorUserEmail:n=!1}=this.loginUser();n||!t||this.authService.login(t).subscribe({next:()=>this.goToTasks(t),error:e=>this.messageError.update(()=>e)})}onRegister(){let{email:t,name:n}=this.registerUser();this.authService.register({email:t,name:n}).subscribe({next:()=>this.goToTasks(t),error:e=>this.messageError.update(()=>e)})}setErrorUserEmail(t){this.loginUser.update(n=>C(_({},n),{errorUserEmail:t}))}setRegisterUserErrors(t,n){if(n){this.registerUserErrors.update(e=>[...e,t]);return}this.registerUserErrors.update(e=>e.filter(s=>s!==t))}goToTasks(t){this.stateService.setEmail(t),this.router.navigate(["/tasks"])}static \u0275fac=function(n){return new(n||i)};static \u0275cmp=w({type:i,selectors:[["app-login"]],standalone:!0,features:[b],decls:18,vars:19,consts:[[1,"login__title"],[1,"login__container"],[1,"login__description"],[3,"ngModelChange","validationError","ngModel","fieldOptions"],[1,"mt-1",3,"click"],[3,"showDialog"],[1,"register__title"],[1,"register__description"],[3,"ngSubmit"],["name","name",3,"ngModelChange","validationError","ngModel","fieldOptions"],["name","email",3,"ngModelChange","validationError","ngModel","fieldOptions"],[1,"mt-1",3,"squareButton"]],template:function(n,e){n&1&&(o(0,"h1",0),l(1,"Square"),a(),o(2,"section",1)(3,"p",2),l(4,"Enter email to log in"),a(),o(5,"app-square-field",3),E("ngModelChange",function(r){return h(e.loginUser().email,r)||(e.loginUser().email=r),r}),d("validationError",function(r){return e.setErrorUserEmail(r)}),a(),o(6,"app-square-button",4),d("click",function(){return e.onLogin()}),l(7," Sign in "),a()(),o(8,"app-square-dialog",5)(9,"h2",6),l(10,"Email Not Registered"),a(),o(11,"p",7),l(12,"Please enter your name and email to register."),a(),o(13,"form",8),d("ngSubmit",function(){return e.onRegister()}),o(14,"app-square-field",9),E("ngModelChange",function(r){return h(e.registerUser().name,r)||(e.registerUser().name=r),r}),d("validationError",function(r){return e.setRegisterUserErrors("required",r)}),a(),o(15,"app-square-field",10),E("ngModelChange",function(r){return h(e.registerUser().email,r)||(e.registerUser().email=r),r}),d("validationError",function(r){return e.setRegisterUserErrors("mail",r)}),a(),o(16,"app-square-button",11),l(17," Submit "),a()()()),n&2&&(p(5),f("ngModel",e.loginUser().email),g("fieldOptions",c(9,A,S(8,x))),p(3),g("showDialog",e.showRegisterDialog()),p(6),f("ngModel",e.registerUser().name),g("fieldOptions",c(12,V,S(11,G))),p(),f("ngModel",e.registerUser().email),g("fieldOptions",c(15,A,S(14,x))),p(),g("squareButton",c(17,H,e.disabledRegisterButton())))},dependencies:[q,z,B,N,k,P,L,T,R,O],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:100%;height:100%}.login__title[_ngcontent-%COMP%]{font-size:var(--font-xl);font-family:Roboto Mono;font-weight:700;line-height:3.875rem;margin:0;padding:0;color:var(--dark-color)}.login__description[_ngcontent-%COMP%]{font-size:var(--font-sm);font-family:Roboto Mono;font-weight:500;line-height:1.1875rem}.login__container[_ngcontent-%COMP%]{width:80%;margin-top:1rem;box-sizing:border-box}.register__title[_ngcontent-%COMP%]{font-size:1.5rem;font-family:Roboto Mono;font-weight:700;margin:.5rem 0 0;padding:0;color:var(--dark-color);text-wrap:pretty}.register__description[_ngcontent-%COMP%]{font-size:var(--font-sm);font-family:Open Sans;margin:.5rem 0 1rem;padding:0;color:var(--dark-color);text-wrap:pretty}@media (min-width: 640px){.login__container[_ngcontent-%COMP%]{max-width:40rem}}"],changeDetection:0})}return i})();export{ge as LoginComponent};
